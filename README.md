# WinPE解析操作工具（32位）V1.0.0

![](./images/1.png)

![](./images/2.png)

## 一、项目简介

`WinPE解析操作工具`是一款基于**原生C/C++\**开发的轻量级32位Windows PE（Portable Executable）文件分析与操作工具，提供可视化界面与便捷操作，帮助用户快速理解PE文件结构、定位进程加载模块，并验证注入逻辑。

## 二、核心功能

工具涵盖**PE解析**、**进程管理**、**注入操作**三大模块，具体功能如下：

### 1. PE文件解析操作（支持32位.exe/.dll）

- **PE头信息**：显示镜像基址（Image Base）、程序入口（Entry Point）、镜像大小（Image Size）、区段数目（Number of Sections）、校验和（CheckSum）、子系统（Subsystem）等关键字段（如截图中“pe信息”窗口所示）。
- **区段**：列出所有区段（Section）的名称（如`.text`/`.data`）、起始地址、大小、属性（可读/可写/可执行），新增末尾区段
- 表结构：
  - 导入表（Import Table）：显示导入的DLL名称（如`kernel32.dll`）及函数列表（函数名/序数）；
  - 导出表（Export Table）：查看导出的函数名称、地址及序数；
  - 重定位表（Relocation Table）：显示重定位项的地址（如`0x00001000`）及类型（IMAGE_REL_BASED_32）。
  - 导入导出表重定位表移动（会移动到最后一个区段）

### 2. 进程与模块管理

- **实时进程列表**：刷新显示系统当前运行的32位进程，包含进程名称（如`KuGou.exe`）、PID（如`4692`）、镜像基址（如`0x00570000`）、镜像大小（如`0x000E0000`）（如截图中“进程”列表所示）。
- **模块信息**：选中进程后，显示其加载的所有模块（如`ntdll.dll`、`KERNEL32.dll`）及模块位置（内存地址，如`0x77B00000`）。

### 3. 注入操作

- **DLL注入**：选择目标文件，加载并注入指定的32位DLL文件（如`inject.dll`）
- **示例代码注入**：提供预定义的示例注入代码（弹出空白消息框），快速验证注入功能的正确性。

### 4. 软件加壳

- 选择文件后，使用指定的壳程序保护该pe文件。

### 5. 数据保存与导出

- 保存修改后的PE文件（如调整镜像基址或区段信息）；

## 三、使用说明

### 1. 启动工具

双击运行工具可执行文件（如`PE Tool.exe`），进入主界面。

### 2. 解析PE文件

- 点击“选择文件”按钮，打开32位PE文件（如`C:\1.exe`）；
- 打开后，左侧“pe信息”窗口显示PE头与区段信息，右侧显示导入/导出/重定位表。

### 3. 查看进程与模块

- 点击“刷新进程”按钮，获取最新进程列表；
- 选中进程，下方“模块名称”列表显示其加载的模块。

### 4. 执行注入操作

- DLL注入
  1. 选中目标文件
  2. 点击“注入DLL”按钮，输入要注入的dll名，函数名或选择直接注入示例dll；
  3. 等待提示“注入成功”，目标进程会加载该DLL并执行其函数。
- 示例代码注入
  1. 选中目标文件；
  2. 点击“注入示例代码”按钮，目标进程会弹出消息框，提示注入成功。

### 5. 软件加壳(壳程序为shell.exe)

1. 选中目标文件
2. 点击“软件加壳”按钮，选择壳程序，后续将自动加壳保存在./newshell.exe.

### 6. 保存数据

- 修改PE文件信息后，点击“保存”按钮，将修改后的PE文件写入磁盘；